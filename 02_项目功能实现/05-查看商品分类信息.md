## 查看商品分类信息

* 在导航栏中点击对应的商品分类就进入对应的商品分类信息页面：

  * 首先编写dao类，去查询数据库表中的内容（ProductDao）

    ```java
        /**
         * 计算商品表中有多少条记录
         * 
         * @return
         */
        public long getCount(String cid) {
    	String sql = null;
    	long count = 0;
    
    	// 查询主页的情况
    	if (cid == null) {
    	    sql = "select count(pid) from product";
    	    try {
    		count = (long) qr.query(sql, new ScalarHandler());
    	    } catch (SQLException e) {
    		e.printStackTrace();
    	    }
    	} else {// 查询有分类选择商品分类页面的信息
    	    sql = "select count(pid) from product where cid = ?";
    	    try {
    		count = (long) qr.query(sql, new ScalarHandler(), cid);
    	    } catch (SQLException e) {
    		e.printStackTrace();
    	    }
    	}
    	return count;
        }
    
    /**
         * 分页查询商品记录
         * 
         * @param currentPage
         * @param size
         * @return
         */
        public List<Product> getProduct(int currentPage, int size) {
            if(currentPage<=0) {
    	    currentPage=0;
    	}
    	String sql = "SELECT * FROM product LIMIT "+currentPage+","+size+";
    	List<Product> list = null;
    
    	try {
    	    list = qr.query(sql, new BeanListHandler<>(Product.class));
    	} catch (SQLException e) {
    	    e.printStackTrace();
    	}
    	return list;
        }
    
        /**
         * 通过商品分类id来查询商品信息
         * 
         * @param currentPage
         * @param size
         * @param cid
         * @return
         */
        public List<Product> getProductByCid(int start, int size, String cid) {
            if(start<=0) {
    	    start=0;
    	}
    	String sql = "SELECT * FROM product WHERE cid = ? LIMIT " + start + " , " + size;
    	List<Product> list = null;
    
    	try {
    	    list = qr.query(sql, new BeanListHandler<>(Product.class), cid);
    	} catch (SQLException e) {
    	    e.printStackTrace();
    	}
    	return list;
        }
    
    
    ```
  
* 编写查询商品分类信息页面的ProductListServlet：
  
  ```java
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    	    ProductDao productDao = new ProductDao();
    	    String cid = request.getParameter("cid");
    	    int size = 12; //将商品信息分成每页12条记录
    	    int count = (int)productDao.getCount(cid);//求出商品共有多少条记录
    	    int totalPage = 0; 	//计算总页数
    	    
    	    if(count%size>0) {//判断一共需要分多少页
    		totalPage = count/size +1;
    	    }else {
    		totalPage = count/size;
    	    }
    	    
        	//处理页码信息
    	    String s = request.getParameter("currentPage");//获取页码信息
    	    int currentPage = 1;
    	    if(s!=null) {
    		currentPage=Integer.parseInt(s);
    		if(currentPage<=0) {
    		    currentPage = 1;
    		}
    		if(currentPage>=totalPage) {
    		    currentPage = totalPage;
    		}
    	    }
    	    
    	    List<Product> list = null;
    	    //如果商品信息为空的话 就直接查询  所有商品列表信息
    	    if(cid==null) {
    		//limit （（页面-1）*每页显示数目  就是开始显示的记录行数）
    		list = productDao.getProduct((currentPage-1)*size, size);
    	    }else {//有选择商品分类的情况下
    		request.setAttribute("cid", cid);
    		list = productDao.getProductByCid((currentPage-1)*size, size, cid);
    	    }
    	    
    	    
    	    request.setAttribute("currentPage", currentPage);
    	    request.setAttribute("totalPage", totalPage);
    	    request.setAttribute("productList",  list);
    	    request.getRequestDispatcher("product_list.jsp").forward(request, response);
    	}
  ```
  
  

