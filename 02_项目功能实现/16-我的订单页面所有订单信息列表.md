## 查询所有订单信息页面

* 编写dao类：OrderDao

  ```java
 /**
       *	 根据订单编号来获取订单信息
       * 
       * @param oid
       * @return
       */
      public Order getOrderByOid(String oid) {
  	String sql = "select * from Orders where oid=? order by ordertime desc";
  	Order order = null;
  	try {
  	    order = qr.query(sql, new BeanHandler<Order>(Order.class), oid);
  	} catch (SQLException e) {
  	    e.printStackTrace();
  	}
  	return order;
      }
  
  ```
  
* 编写dao类 根据订单编号查询对应的订单商品信息：OrderItemDao

  ```java
  /**
       * 	根据商品订单id查询对应的订单的商品信息
       * @param oid
       * @return
       */
      public List<OrderItem> getOrderItemByOid(String oid){
  	List<OrderItem> list=null;
  	String sql="select * from OrderItem where oid=?";
  	try {
  		list=qr.query(sql, new BeanListHandler<OrderItem>(OrderItem.class),oid);
  		//执行完这个sql语句后 会见这个返回结果的uid复制给我们product数组
  		List<Product> list1=qr.query(sql, new BeanListHandler<Product>(Product.class),oid);
  		
  		ProductDao productDao=new ProductDao();
  		for(int i=0;i<list.size();i++){
  			Product product = productDao.getProductByPid(list1.get(i).getPid());	
  			list.get(i).setProduct(product);
  		}
  	
  	} catch (SQLException e) {
  		e.printStackTrace();
  	}
  	return list;
      }
  ```

* 编写查询所有订单信息页面

  ```java
  protected void doGet(HttpServletRequest request, HttpServletResponse response)
  	    throws ServletException, IOException {
  	String s = request.getParameter("currentPage");
  	int currentPage = Integer.parseInt(s);
  	OrderDao orderDao = new OrderDao();
  	HttpSession session = request.getSession();
  	User user = (User) session.getAttribute("user");
  	//查看订单列表 如果用户没有登录的话就跳转到登录页面
  	if (user == null) {
  	    response.sendRedirect("login.jsp");
  	} else {
  	    //取出数据库订单表中的订单信息
  	    List<Order> orderList = orderDao.getOrderListByUid(user.getUid());
  	    //查询出每个订单中的订单商品信息
  	    for (Order order : orderList) {
  		order.setOrderItems(new OrderItemDao().getOrderItemByOid(order.getOid()));
  	    }
  	    
  	    List<Order> orderList1 = new ArrayList<Order>();
  	    int n = 5;
  	    int totalPage = 0;
  	    
  	    if(orderList.size()%n>0){
  	    	totalPage = orderList.size()/n+1;
  	    }else{
  	    	totalPage = orderList.size()/n;
  	    }
  	    
  	    for (int i = (currentPage - 1) * n; i < currentPage * n && i < orderList.size(); i++) {
  		orderList1.add(orderList.get(i));
  	    }
  	    
  	    request.setAttribute("currentPage", currentPage);
	    request.setAttribute("totalPage", totalPage);
  	    request.setAttribute("orderList", orderList1);
  	    request.getRequestDispatcher("order_list.jsp").forward(request, response);
  
  	}
      }
  ```
  
  

